/*!CK:3115478866!*//*1449519575,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["+EYZr"]); }

__d('ReactComposerPhotoUploadsGrid.react',['ReactComposerContextMixin','ReactComposerDraggablePhoto.react','ReactComposerGenericPhotoUploadLink.react','ReactComposerMediaScrollableArea.react','ReactComposerMediaUtils','ReactComposerPhotoUploadActions','FileInput.react','immutable','ReactComponentWithPureRenderMixin','React','ReactDOM','cx','fbt','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){'use strict';if(c.__markCompiled)c.__markCompiled();var v=q.PropTypes,w=112,x=q.createClass({displayName:'ReactComposerPhotoUploadsGrid',mixins:[p,h],propTypes:{enableFaceboxTagger:v.bool,disablePhotoEditing:v.bool,addMorePhotosConfig:v.shape({maxPhotos:v.number}).isRequired,mediaAcceptParam:v.string,mediaConfig:v.object.isRequired,nuxConfig:v.object.isRequired,onFilesSelected:v.func,canUploadMultiplePhotos:v.bool,uploads:v.instanceOf(o.List).isRequired,onDrop:v.func,photoUploadLink:v.element,scrollableAreaHeight:v.number.isRequired,sourceIndex:v.number,targetIndex:v.number,updateComponentPosition:v.func.isRequired},getDefaultProps:function(){return {addMorePhotosConfig:{},canUploadMultiplePhotos:false,photoUploadLink:q.createElement(j,null),scrollableAreaHeight:w,showSellUploadLink:false};},render:function(){return (q.createElement('div',{className:"_58hb"},q.createElement('div',{className:u("_58hc",this.props.className)},q.createElement(k,{fade:true,getAddMoreDOM:this._getAddMoreDOM,height:this.props.scrollableAreaHeight,photosCount:this.props.uploads.size,scrollbar:'fade',verticalScroll:true},this.props.children,this._getComponents(),this._getAddMorePhotosButton()))));},_onAddMorePhotosClick:function(){m.inputClicked(this.context.composerID);},_onFilesSelected:function(event){if(this.props.onFilesSelected){var y=this.props.onFilesSelected;y(event,this.refs.fileInput.getFileInput());}l.clearInput(this.refs.fileInput.getFileInput());},_getAddMorePhotosButton:function(){if(!this.props.canUploadMultiplePhotos&&this.props.uploads.size>0)return null;if(this.props.addMorePhotosConfig.maxPhotos&&this.props.uploads.size>=this.props.addMorePhotosConfig.maxPhotos)return null;return (q.createElement('span',{ref:'addMore',className:"_58i2"},q.createElement(n,{accept:this.props.mediaAcceptParam,multiple:this.props.canUploadMultiplePhotos,name:'composer_photo',onChange:this._onFilesSelected,onClick:this._onAddMorePhotosClick,ref:'fileInput',title:t._("Choose a file to upload"),'data-testid':'add-more-photos'},this.props.photoUploadLink)));},_getComponents:function(){var y=this.props.uploads.toSeq().filter((function(aa,ba){return ba!==this.props.sourceIndex;}).bind(this)).map((function(aa,ba){return this._getDraggablePhoto(aa,ba);}).bind(this));if(this.props.targetIndex!=null){var z=q.createElement('div',{key:'placeholder',className:"_4e74"});y=y.splice(this.props.targetIndex,0,z);}if(this.props.sourceIndex!=null)y=y.splice(this.props.sourceIndex,0,this._getDraggablePhoto(this.props.uploads.get(this.props.sourceIndex)));return y.toArray();},_getDraggablePhoto:function(y,z){return (q.createElement(i,{enableFaceboxTagger:this.props.enableFaceboxTagger,disablePhotoEditing:this.props.disablePhotoEditing,key:y.id,nuxConfig:this.props.nuxConfig,upload:y,draggingPhotos:this.props.sourceIndex!=null,index:z,mediaConfig:this.props.mediaConfig,updateComponentPosition:this.props.updateComponentPosition,onGrab:this.props.onGrab,onDrag:this.props.onDrag,onDrop:this.props.onDrop}));},_getAddMoreDOM:function(){return r.findDOMNode(this.refs.addMore);}});f.exports=x;},null);